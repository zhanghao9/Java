当两个或两个以上的线程在执行过程中，因为争夺资源而造成的一种相互等待的状态，由于存在一种环路的锁依赖关系而永远地等待下去，
如果没有外部干涉，他们将永远等待下去，此时的这个状态称之为死锁

二、死锁的四个必要条件

1.互斥条件：指进程对所分配到的资源进行排它性使用，即在一段时间内某资源只由一个进程占用。如果此时还有其它进程请求资源，则请求者只能等待，
直至占有资源的进程用完释放。

2.请求和保持条件：指进程已经保持至少一个资源，但又提出了新的资源请求，而该资源已被其它进程占有，此时请求进程阻塞，
但又对自己已获得的其它资源保持不放。

3.不剥夺条件：指进程已获得的资源，在未使用完之前，不能被剥夺，只能在使用完时由自己释放。

4.环路等待条件：指在发生死锁时，必然存在一个进程——资源的环形链，即进程集合{A，B，C，···，Z} 中的A正在等待一个B占用的资源；
B正在等待C占用的资源，……，Z正在等待已被A占用的资源。

三、预防死锁
1.破坏互斥条件：使资源同时访问而非互斥使用，就没有进程会阻塞在资源上，从而不发生死锁

2.破坏请求和保持条件：采用静态分配的方式，静态分配的方式是指进程必须在执行之前就申请需要的全部资源，
且直至所要的资源全部得到满足后才开始执行，

只要有一个资源得不到分配，也不给这个进程分配其他的资源。

3.破坏不剥夺条件：即当某进程获得了部分资源，但得不到其它资源，则释放已占有的资源，但是只适用于内存和处理器资源。

4.破坏循环等待条件：给系统的所有资源编号，规定进程请求所需资源的顺序必须按照资源的编号依次进行。

四、死锁检测
对资源的分配加以适当限制可防止或避免死锁发生，但不利于进程对系统资源的充分共享。
为每个进程和每个资源指定一个唯一的号码

Jstack命令
	jstack用于生成java虚拟机当前时刻的线程快照。线程快照是当前java虚拟机内每一条线程正在执行的方法堆栈的集合，
生成线程快照的主要目的是定位线程出现长时间停顿的原因，如线程间死锁、死循环、请求外部资源导致的长时间等待，线程
出现停顿的时候通过jstack来查看各个线程的调用堆栈，就可以知道没有响应的线程到底在后台做什么事情，或者等待什么资源。

JConsole工具
Jconsole是JDK自带的监控工具，在JDK/bin目录下可以找到。它用于连接正在运行的本地或者远程的JVM，对运行在Java应用程序的资
源消耗和性能进行监控，并画出大量的图表，提供强大的可视化界面。而且本身占用的服务器内存很小，甚至可以说几乎不消耗。 

五、死锁恢复
资源剥夺：剥夺陷于死锁的进程所占用的资源，但并不撤销此进程，直至死锁解除
进程回退：根据系统保存的检查点让所有的进程回退，直到足以解除死锁，这种措施要求系统建立保存检查点、回退及重启机制
进程撤销：
	1、撤销陷入死锁的所有进程，解除死锁，继续运行。
	2、逐个撤销陷入死锁的进程，回收其资源并重新分配，直至死锁解除。
		可选择符合下面条件之一的先撤销：
						1.CPU消耗时间最少者 
						2.产生的输出量最小者
						3.预计剩余执行时间最长者 
						4.分得的资源数量最少者后优先级最低者





























